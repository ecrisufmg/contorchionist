#N canvas 892 52 1011 616 12;
#X declare -path ..;
#X declare -path ../../../../..;
#N canvas 1223 121 946 765 classification 0;
#X obj 100 101 cnv 2 350 2 empty empty CLASSIFICATION 5 12 0 14 #606060 #404040 0;
#X obj 100 167 cnv 2 350 2 empty empty empty 0 12 0 12 #606060 #404040 0;
#X obj 505 20 inlet;
#X floatatom 533 226 5 0 0 1 classification - - 0;
#X text 526 305 0 = agogo;
#X text 526 325 1 = berimbau;
#X msg 533 279 agogô;
#N canvas 294 104 697 646 class 0;
#X obj 277 271 outlet;
#X obj 281 112 inlet;
#X obj 281 135 sel 0 1;
#X msg 371 213 set berimbau;
#X msg 279 211 set agogô;
#X connect 1 0 2 0;
#X connect 2 0 4 0;
#X connect 2 1 3 0;
#X connect 3 0 0 0;
#X connect 4 0 0 0;
#X restore 533 256 pd class;
#X listbox 105 137 23 0 0 2 - - - 16;
#X text 627 372 0: "crushed_to_ordinario" \, 1: "ordinario_to_crushed" \, 2: "pizzicato_bartok" \, 3: "trill_major_second_up" \, 4: "trill_minor_second_up", f 33;
#X obj 152 236 sel 0 1 2 3 4 5, f 32;
#X msg 297 299 set trill minor second up;
#X msg 223 425 set pizzicato;
#X floatatom 341 137 8 0 0 2 probability - - 16;
#X msg 259 390 set trill;
#X obj 513 76 cyclone/maximum;
#X obj 506 45 torch.activation softmax 4;
#X msg 144 498 set overpressure->ordinario;
#X msg 190 468 set ordinario->overpressure;
#X connect 2 0 16 0;
#X connect 3 0 7 0;
#X connect 7 0 6 0;
#X connect 10 0 17 0;
#X connect 10 1 18 0;
#X connect 10 2 12 0;
#X connect 10 3 14 0;
#X connect 11 0 8 0;
#X connect 12 0 8 0;
#X connect 14 0 8 0;
#X connect 15 0 13 0;
#X connect 15 1 10 0;
#X connect 16 0 15 0;
#X connect 17 0 8 0;
#X connect 18 0 8 0;
#X coords 0 -1 1 1 350 70 2 100 100;
#X restore 255 456 pd classification;
#X obj 23 14 declare -path ..;
#X obj 255 416 torch.ts -v;
#X msg 159 53 stop;
#X obj 57 51 bng 19 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X obj 56 99 output~;
#X obj 255 328 route tensor;
#X obj 518 324 t b b;
#X msg 518 350 clear;
#X obj 580 331 loadbang;
#X text 339 28 Convolutional Neural Network classifier;
#X text 356 51 - 4 2D convolutional layers;
#X text 355 68 - Multi-head attention;
#X text 355 83 - Linear layers;
#N canvas 1163 31 1383 1021 soundfile 0;
#X text 18 46 recebe o endereço da pasta ->;
#X obj 19 136 table \$0-sound;
#X obj 225 246 soundfiler;
#X floatatom 225 273 15 0 0 1 samples - - 0;
#X obj 225 296 / 44100;
#X floatatom 225 320 10 0 0 1 length\ (seconds) - - 0;
#X obj 291 345 s sample-length;
#X obj 225 369 t b b b;
#X obj 546 142 tabplay~ \$0-sound;
#X obj 271 391 s play;
#X obj 560 80 r play;
#N canvas 400 112 661 397 counter_files 0;
#X obj 168 235 f 0;
#X obj 224 234 + 1;
#X msg 343 213 0;
#X obj 168 336 outlet;
#X obj 356 20 inlet;
#X obj 344 180 r reset_analysis;
#X obj 167 172 spigot;
#X msg 224 151 1;
#X obj 224 261 sel 4;
#X msg 276 190 0;
#X obj 224 313 t b b;
#X obj 167 13 inlet;
#X obj 256 239 r files_size;
#X obj 356 47 t b b b;
#X connect 0 0 1 0;
#X connect 0 0 3 0;
#X connect 1 0 0 1;
#X connect 1 0 8 0;
#X connect 2 0 0 1;
#X connect 4 0 13 0;
#X connect 5 0 2 0;
#X connect 6 0 0 0;
#X connect 7 0 6 1;
#X connect 8 0 10 0;
#X connect 9 0 6 1;
#X connect 10 0 2 0;
#X connect 10 1 9 0;
#X connect 11 0 6 0;
#X connect 12 0 8 1;
#X connect 13 0 6 0;
#X connect 13 1 7 0;
#X connect 13 2 2 0;
#X restore 225 88 pd counter_files;
#X floatatom 134 102 5 0 0 0 exemplos - exemplos 0;
#X obj 382 129 bng 19 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X obj 225 162 t a b;
#X msg 569 108 stop;
#X obj 225 46 r files;
#X obj 694 214 s files;
#X obj 814 23 loadbang;
#X obj 814 45 t b b;
#X obj 814 218 s files_size;
#X floatatom 909 162 5 0 0 0 - - - 0;
#X obj 334 29 inlet;
#X obj 334 52 t b b;
#X obj 366 75 s reset_analysis;
#X obj 546 48 inlet;
#X obj 720 103 bng 19 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X obj 225 422 s analize;
#X obj 546 195 outlet~;
#X msg 620 103 bang;
#X obj 662 166 t b b;
#X obj 847 92 text define files;
#X obj 814 128 text size files;
#X obj 225 135 text get files;
#X obj 514 224 s~ in_signal;
#X msg 846 70 read ../resources/data/test_files.txt;
#X obj 1166 14 declare -path ../../../../..;
#X obj 225 194 pack s f \$0;
#X msg 225 220 read -resize \$1 \$3-sound;
#X obj 614 195 outlet~;
#X obj 694 190 del 2000;
#X text 1129 71 use your own audio files!!!;
#X connect 2 0 3 0;
#X connect 3 0 4 0;
#X connect 4 0 5 0;
#X connect 5 0 6 0;
#X connect 5 0 7 0;
#X connect 7 0 27 0;
#X connect 7 2 9 0;
#X connect 8 0 28 0;
#X connect 8 0 34 0;
#X connect 8 0 39 0;
#X connect 8 1 30 0;
#X connect 10 0 8 0;
#X connect 11 0 12 0;
#X connect 11 0 33 0;
#X connect 13 0 11 1;
#X connect 14 0 37 0;
#X connect 15 0 8 0;
#X connect 16 0 11 0;
#X connect 18 0 19 0;
#X connect 19 0 32 0;
#X connect 19 1 35 0;
#X connect 22 0 23 0;
#X connect 23 0 11 1;
#X connect 23 1 24 0;
#X connect 25 0 8 0;
#X connect 26 0 32 0;
#X connect 29 0 8 0;
#X connect 30 1 40 0;
#X connect 32 0 21 0;
#X connect 32 0 20 0;
#X connect 33 0 14 0;
#X connect 35 0 31 0;
#X connect 37 0 38 0;
#X connect 38 0 2 0;
#X connect 40 0 17 0;
#X restore 57 75 pd soundfile;
#X f 15;
#X obj 254 141 r~ in_signal;
#X text 757 175 <-- Melspectrogram;
#X text 530 301 <-- Create a tensor with the accumulated frames;
#X obj 269 370 loadbang;
#X text 5 416 Loads the CNN TorchScript model -->;
#X obj 255 302 torch.ls2tensor melspec -shape 192 165;
#X msg 270 392 load ../resources/ts/CNN_192_4096.ts;
#X obj 254 167 torch.melspectrogram~ -n_mels 192 -n_fft 4096 -hop 512 -win hann -norm power -fmin 0 -fmax 20500 -fb_norm slaney -melmode energy -unit power -melcalc htk -v, f 71;
#N canvas 482 31 1143 620 gate 0;
#X obj 802 250 list split 10;
#X obj 802 309 expr if($f1 == 0 \, 0 \, if($f2 == 0 \, 0 \, if($f3 == 0 \, 0 \, if($f4 == 0 \, 0 \, if($f5 == 0 \, 0 \, if($f6 == 0 \, 0 \, if($f7 == 0 \, 0 \, if($f8 == 0 \, 0 \, if($f9 == 0 \, 0 \, if($f10 == 0 \, 0 \, 1)))))))))), f 47;
#X obj 802 274 unpack f f f f f f f f f f, f 47;
#X obj 763 373 spigot;
#X obj 761 221 t l l;
#X obj 152 68 inlet;
#X obj 257 72 bang~;
#X obj 258 177 f;
#X obj 290 177 + 1;
#X msg 349 200 0;
#X floatatom 258 288 5 0 0 0 - - - 0;
#X obj 360 253 print 165-frames;
#X obj 349 172 loadbang;
#X obj 258 135 spigot;
#X obj 297 110 r reset-frames;
#X obj 309 280 s reset-frames;
#X msg 309 251 0;
#X obj 907 95 s reset-frames;
#X msg 907 68 1;
#X msg 943 66 0;
#X obj 944 45 loadbang;
#X obj 154 440 spigot;
#X obj 192 417 r reset-frames;
#X obj 429 213 sel 1377;
#X obj 309 228 sel 1377;
#X obj 907 17 r play;
#X obj 154 461 outlet;
#X connect 0 0 2 0;
#X connect 1 0 3 1;
#X connect 2 0 1 0;
#X connect 2 1 1 1;
#X connect 2 2 1 2;
#X connect 2 3 1 3;
#X connect 2 4 1 4;
#X connect 2 5 1 5;
#X connect 2 6 1 6;
#X connect 2 7 1 7;
#X connect 2 8 1 8;
#X connect 2 9 1 9;
#X connect 4 0 3 0;
#X connect 4 1 0 0;
#X connect 5 0 21 0;
#X connect 6 0 13 0;
#X connect 7 0 8 0;
#X connect 7 0 10 0;
#X connect 7 0 24 0;
#X connect 8 0 7 1;
#X connect 9 0 7 1;
#X connect 12 0 9 0;
#X connect 13 0 7 0;
#X connect 14 0 13 1;
#X connect 16 0 15 0;
#X connect 18 0 17 0;
#X connect 19 0 17 0;
#X connect 20 0 19 0;
#X connect 21 0 26 0;
#X connect 22 0 21 1;
#X connect 24 0 9 0;
#X connect 24 0 11 0;
#X connect 24 0 16 0;
#X connect 25 0 18 0;
#X restore 254 218 pd gate;
#X obj 254 241 s \$0-melspec-data;
#X obj 255 275 r \$0-melspec-data;
#X obj 551 378 s \$0-melspec-data;
#X connect 2 0 0 0;
#X connect 3 0 14 1;
#X connect 4 0 14 0;
#X connect 6 0 2 0;
#X connect 7 0 8 0;
#X connect 7 1 26 0;
#X connect 8 0 26 0;
#X connect 9 0 8 0;
#X connect 14 0 5 0;
#X connect 14 1 5 1;
#X connect 15 0 22 0;
#X connect 18 0 21 0;
#X connect 20 0 6 0;
#X connect 20 1 7 0;
#X connect 21 0 2 0;
#X connect 22 0 23 0;
#X connect 23 0 24 0;
#X connect 25 0 20 0;
